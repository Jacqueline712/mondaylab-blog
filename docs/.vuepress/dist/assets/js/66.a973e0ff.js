(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{614:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"🔔-序言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🔔-序言"}},[t._v("#")]),t._v(" 🔔 序言")]),t._v(" "),a("p",[t._v("对于 "),a("code",[t._v("webpack")]),t._v(" 来说， "),a("code",[t._v("loader")]),t._v(" 和 "),a("code",[t._v("plugin")]),t._v(" 可以算是需求程度最为广泛的配置项了。但是呢，单单止步于配置可能还不够。如果我们自己有时候想要 "),a("code",[t._v("diy")]),t._v(" 一个需求，但是 "),a("code",[t._v("webpack")]),t._v(" 又没有相关的 "),a("code",[t._v("loader")]),t._v(" 和 "),a("code",[t._v("plugin")]),t._v(" 。那这个时候我们可能就得开始造点轮子来供给自己使用了。")]),t._v(" "),a("p",[t._v("因此，在今天的文章当中，将带领大家手写一个简易的 "),a("code",[t._v("loader")]),t._v(" 和 "),a("code",[t._v("plugin")]),t._v(" ，并学会如何在项目中运用自己所编写的 "),a("code",[t._v("loader")]),t._v(" 和 "),a("code",[t._v("plugin")]),t._v(" 。")]),t._v(" "),a("p",[t._v("一起来学习吧~📢")]),t._v(" "),a("h1",{attrs:{id:"🎵-一、如何编写一个-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🎵-一、如何编写一个-loader"}},[t._v("#")]),t._v(" 🎵 一、如何编写一个 Loader")]),t._v(" "),a("h2",{attrs:{id:"_1-碎碎念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-碎碎念"}},[t._v("#")]),t._v(" 1. 碎碎念")]),t._v(" "),a("p",[t._v("之前的文章中我们讲到了关于 "),a("code",[t._v("loader")]),t._v(" 的一些配置。那如果把那些引用的 "),a("code",[t._v("loader")]),t._v(" 改为我们写的 "),a("code",[t._v("loader")]),t._v(" ，该怎么处理呢？")]),t._v(" "),a("p",[t._v("现在，我们来了解一下，如何手写一个简易的 "),a("code",[t._v("loader")]),t._v(" ，并运用到我们的项目当中。")]),t._v(" "),a("h2",{attrs:{id:"_2-项目结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-项目结构"}},[t._v("#")]),t._v(" 2. 项目结构")]),t._v(" "),a("p",[t._v("首先用一张图，来看我们的"),a("strong",[t._v("项目结构")]),t._v("。"),a("strong",[t._v("如下图所示：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/0139727bc88b48bd8fffbc4273691f8a.png#",alt:"loader项目结构"}})]),t._v(" "),a("p",[t._v("其中 "),a("code",[t._v("loaders")]),t._v(" 文件夹下放置我们想要写的 "),a("code",[t._v("loader")]),t._v(" ，同时里面的 "),a("code",[t._v("replaceLoader.js")]),t._v(" 文件放置我们即将要写的 "),a("code",[t._v("loader")]),t._v(" 的代码逻辑。之后，"),a("code",[t._v("index.js")]),t._v(" 文件是我们的"),a("strong",[t._v("入口文件")]),t._v("，放置我们的业务逻辑。 "),a("code",[t._v("webpack.config.js")]),t._v(" 文件放置关于 "),a("code",[t._v("webpack")]),t._v(" 的相关配置，而 "),a("code",[t._v("dist")]),t._v(" 文件夹内的内容，放置的是我们通过 "),a("code",[t._v("webpack")]),t._v(" 打包后，生成的打包文件。")]),t._v(" "),a("h2",{attrs:{id:"_3-业务代码编写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-业务代码编写"}},[t._v("#")]),t._v(" 3. 业务代码编写")]),t._v(" "),a("h3",{attrs:{id:"_1-入口文件代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-入口文件代码"}},[t._v("#")]),t._v(" （1）入口文件代码")]),t._v(" "),a("p",[t._v("现在，我们先来编写入口文件 "),a("code",[t._v("index.js")]),t._v(" 的代码。"),a("strong",[t._v("具体代码如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-编写-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写-loader"}},[t._v("#")]),t._v(" （2）编写 loader")]),t._v(" "),a("p",[t._v("入口文件的内容很简单，我们想要达到的目的就是输出 "),a("code",[t._v("hello monday")]),t._v(" 这个语句。现在，我们来编写 "),a("code",[t._v("loader")]),t._v(" 的内容，已达到对入口文件 "),a("code",[t._v("index.js")]),t._v(" 的内容进行修改。 "),a("code",[t._v("replaceLoader.js")]),t._v(" 文件的"),a("strong",[t._v("代码具体如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mondaylab'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("hr"),t._v(" "),a("p",[t._v("以上的代码意思为，将入口文件 "),a("code",[t._v("index.js")]),t._v(" 文件中的 "),a("code",[t._v("monday")]),t._v(" 替换为 "),a("code",[t._v("mondaylab")]),t._v(" 。这样写似乎没啥问题，但是大家有没有想过，我们有时候传的属性可能会很诡异，不一定每次都能像这样以字符串的形式来替换。")]),t._v(" "),a("p",[t._v("所以，我们引用 "),a("code",[t._v("webpack")]),t._v(" 官方推荐的 "),a("code",[t._v("loadertils")]),t._v(" 这个工具，来解决这个问题。")]),t._v(" "),a("p",[a("strong",[t._v("第一步：")]),t._v(" 安装 "),a("code",[t._v("loader-utils")]),t._v(" 插件。"),a("strong",[t._v("具体命令如下：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" loader-utils --save-dev\n")])])]),a("p",[a("strong",[t._v("第二步：")]),t._v(" 改造 "),a("code",[t._v("loader")]),t._v(" 文件。接下来，我们对 "),a("code",[t._v("replaceLoader.js")]),t._v(" 文件进行改造升级，"),a("strong",[t._v("具体代码如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" loaderUtils "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loader-utils'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//用function的原因在于为了业务层可以调用this")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//source为引入文件的源代码")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//getOptions会自动地帮我们分析this.query,然后把参数的所有内容放在options里面去")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" loaderUtils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOptions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("大家可以看到，通过使用 "),a("code",[t._v("loaderUtils")]),t._v(" 插件，间接地，调用 "),a("code",[t._v("getOptions")]),t._v(" 方法，来自动的帮我们分析 "),a("code",[t._v("this.query")]),t._v(" ，从而取到我们想要的内容。")]),t._v(" "),a("p",[t._v("值得注意的是，我们还需要再了解一下 "),a("code",[t._v("this.callback")]),t._v(" 的内容。")]),t._v(" "),a("p",[t._v("一般情况下，如果我们接收到了源代码 "),a("code",[t._v("source")]),t._v(" ，那么现在我们只能对源代码做处理。但是呢，有的时候，我们想要使用一些 "),a("code",[t._v("sourceMap")]),t._v(" ，或者对源代码分析好了之后，我们不仅想要返回源代码，还要把 "),a("code",[t._v("sourceMap")]),t._v(" 也带回去。")]),t._v(" "),a("p",[t._v("因为我们 "),a("code",[t._v("return")]),t._v(" 的时候只能 "),a("code",[t._v("return")]),t._v(" 一个参数，其余的一些额外的内容就带不出去了。这个时候呢，我们就需要 "),a("code",[t._v("this.callback")]),t._v(" 来帮我们把 "),a("code",[t._v("sourceMap")]),t._v(" 给带出去。因此，一般用 "),a("code",[t._v("this.callback")]),t._v(" 来返回内容。")]),t._v(" "),a("h3",{attrs:{id:"_3-引用-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-引用-loader"}},[t._v("#")]),t._v(" （3）引用 loader")]),t._v(" "),a("p",[t._v("现在，我们在 "),a("code",[t._v("webpack.config.js")]),t._v(" 中，来引入我们上面的 "),a("code",[t._v("loader")]),t._v(" 。"),a("strong",[t._v("具体配置如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'development'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/index.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("module")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./loaders/replaceLoader.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上面的options.name中的name")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mondaylab'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("通过以上方式，我们写了一个简易的 "),a("code",[t._v("loader")]),t._v(" ，这个 "),a("code",[t._v("loader")]),t._v(" 实现了将 "),a("code",[t._v("monday")]),t._v(" 替换为 "),a("code",[t._v("mondaylab")]),t._v(" 的功能。并且供我们在 "),a("code",[t._v("webpack")]),t._v(" 中使用自己书写的 "),a("code",[t._v("loader")]),t._v(" 。")]),t._v(" "),a("h3",{attrs:{id:"_4-在-loader-里面做一些异步的操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-在-loader-里面做一些异步的操作"}},[t._v("#")]),t._v(" （4）在 loader 里面做一些异步的操作")]),t._v(" "),a("p",[t._v("好了现在，如果我们想要给 "),a("code",[t._v("loader")]),t._v(" 做一些异步操作，该怎么实现呢？")]),t._v(" "),a("p",[t._v("在我们所写的 "),a("code",[t._v("loader")]),t._v(" 当中，加入异步操作，那么我们需要调用官方提供给我们的 "),a("code",[t._v("this.async()")]),t._v(" 这个 "),a("code",[t._v("API")]),t._v(" 来实现。现在，我们来改造一下 "),a("code",[t._v("replaceLoader.js")]),t._v(" 文件的代码。"),a("strong",[t._v("具体代码如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" loaderUtils "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'loader-utils'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" loaderUtils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOptions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//调用this.async()这个API，来给异步代码使用")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" callback "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("通过这种方式，我们就可以在 "),a("code",[t._v("loader")]),t._v(" 中编写异步代码，来达到我们想要的效果。")]),t._v(" "),a("h3",{attrs:{id:"_5-loader-路径自定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-loader-路径自定义"}},[t._v("#")]),t._v(" （5）loader 路径自定义")]),t._v(" "),a("p",[t._v("有一个很小的注意点就是，当我们在配置 "),a("code",[t._v("webpack.config.js")]),t._v(" 文件中， "),a("code",[t._v("loader")]),t._v(" 的路径时，每回都要 "),a("code",[t._v("path.resolve")]),t._v(" 去寻找路径文件。文件少的时候还好，但如果遇到多文件的时候呢？岂不是会很麻烦。")]),t._v(" "),a("p",[t._v("所以，我们引用 "),a("code",[t._v("resolveLoader")]),t._v(" 来简化它。现在我们在 "),a("code",[t._v("webpack.config.js")]),t._v(" 文件中进行改造。"),a("strong",[t._v("具体配置如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 先到node_modules中去找，找不到则去./loaders目录下去找")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resolveLoader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("modules")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./loaders'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("module")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("rules")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loader")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'replaceLoader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("通过配置 "),a("code",[t._v("resolveLoader")]),t._v(" ，来对文件文件目录进行查找，从而简化了路径内容。")]),t._v(" "),a("h1",{attrs:{id:"🎶-二、如何编写一个-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🎶-二、如何编写一个-plugin"}},[t._v("#")]),t._v(" 🎶 二、如何编写一个 Plugin")]),t._v(" "),a("h2",{attrs:{id:"_1-碎碎念-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-碎碎念-2"}},[t._v("#")]),t._v(" 1. 碎碎念")]),t._v(" "),a("p",[t._v("在讲解 "),a("code",[t._v("plugin")]),t._v(" 之前，我们先来了解 "),a("code",[t._v("loader")]),t._v(" 和 "),a("code",[t._v("plugin")]),t._v(" 的区别。")]),t._v(" "),a("p",[t._v("当我们在源代码里面，去引入一个新的 "),a("code",[t._v("js")]),t._v(" 文件，或者是一个其他格式的文件时，这个时候我们可以借用 "),a("code",[t._v("loader")]),t._v(" ，来帮我们处理我们引用的 "),a("code",[t._v("loader")]),t._v(" 文件。 "),a("code",[t._v("loader")]),t._v(" 的作用就在于，帮助我们"),a("strong",[t._v("处理引用的模块")]),t._v("。")]),t._v(" "),a("p",[t._v("而 "),a("code",[t._v("plugin")]),t._v(" 呢，是当我们在做打包的时候，在"),a("strong",[t._v("某些具体时刻上")]),t._v("，比如说，当我们打包结束之后，我们要生成一个 "),a("code",[t._v("html")]),t._v(" 文件，这个时候，我们就可以使用一个 "),a("code",[t._v("htmlWebpackPlugin")]),t._v(" 的插件。使用它之后，他就会在打包结束之后，帮我们生成对应的 "),a("code",[t._v("html")]),t._v(" 文件。")]),t._v(" "),a("p",[t._v("再比如，我们要在打包之前，把 "),a("code",[t._v("dist")]),t._v(" 目录进行清空，这个时候我们就可以使用 "),a("code",[t._v("cleanWebpackPlugin")]),t._v(" 来帮助我们做这件事情。")]),t._v(" "),a("p",[t._v("所以， "),a("code",[t._v("plugin")]),t._v(" 插件，在什么时候生效呢？")]),t._v(" "),a("p",[t._v("它在我们"),a("strong",[t._v("打包过程中的某些时刻里")]),t._v("，就是"),a("strong",[t._v("插件生效的场景")]),t._v("。")]),t._v(" "),a("p",[a("code",[t._v("plugin")]),t._v(" 的编写相对于 "),a("code",[t._v("loader")]),t._v(" 来说，会难一点点。但是呢，如果有看过 "),a("code",[t._v("webpack")]),t._v(" 源码的小伙伴们可能会知道， "),a("code",[t._v("webpack")]),t._v(" 的一些底层原理都是依据 "),a("code",[t._v("plugin")]),t._v(" 来进行编写的。所以，我们还是有必要来学习一下 "),a("code",[t._v("plugin")]),t._v(" 的编写。")]),t._v(" "),a("p",[t._v("下面就带领大家来编写一个简易的 "),a("code",[t._v("plugin")]),t._v(" ~")]),t._v(" "),a("h2",{attrs:{id:"_2-项目结构-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-项目结构-2"}},[t._v("#")]),t._v(" 2. 项目结构")]),t._v(" "),a("p",[t._v("对于 "),a("code",[t._v("webpack")]),t._v(" 的 "),a("code",[t._v("plugin")]),t._v(" 来说，它是是基于"),a("strong",[t._v("发布者订阅")]),t._v("的设计模式，也可以说是基于"),a("strong",[t._v("事件驱动")]),t._v("来实现的。在这个事件驱动里，代码之间的执行，是通过事件来进行驱动的。")]),t._v(" "),a("p",[t._v("接下来，我们就来写一个简易的 "),a("code",[t._v("plugin")]),t._v(" 。")]),t._v(" "),a("p",[t._v("首先用一张图，来看我们的"),a("strong",[t._v("项目结构")]),t._v("。"),a("strong",[t._v("如下图所示：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/3d46496df8b54a1d990190e0de9aa56d.png#",alt:"plugin项目结构"}})]),t._v(" "),a("p",[t._v("其中 "),a("code",[t._v("plugins")]),t._v(" 文件夹下放置我们想要写的 "),a("code",[t._v("plugin")]),t._v(" ，同时里面的 "),a("code",[t._v("copyright-webpack-plugin.js")]),t._v(" 文件放置我们即将要写的 "),a("code",[t._v("plugin")]),t._v(" 的代码逻辑。之后，"),a("code",[t._v("index.js")]),t._v(" 文件是我们的"),a("strong",[t._v("入口文件")]),t._v("，放置我们的业务逻辑。 "),a("code",[t._v("webpack.config.js")]),t._v(" 文件放置关于 "),a("code",[t._v("webpack")]),t._v(" 的相关配置，而 "),a("code",[t._v("dist")]),t._v(" 文件夹内的内容，放置的是我们通过 "),a("code",[t._v("webpack")]),t._v(" 打包后，生成的打包文件。")]),t._v(" "),a("h2",{attrs:{id:"_3-业务代码编写-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-业务代码编写-2"}},[t._v("#")]),t._v(" 3. 业务代码编写")]),t._v(" "),a("h3",{attrs:{id:"_1-入口文件代码-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-入口文件代码-2"}},[t._v("#")]),t._v(" （1）入口文件代码")]),t._v(" "),a("p",[t._v("现在，我们先来编写入口文件 "),a("code",[t._v("index.js")]),t._v(" 的代码。"),a("strong",[t._v("具体代码如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-编写-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写-plugin"}},[t._v("#")]),t._v(" （2）编写 plugin")]),t._v(" "),a("p",[t._v("现在，我们来编写 "),a("code",[t._v("plugin")]),t._v(" 的内容， "),a("code",[t._v("copyright-webpack-plugin.js")]),t._v(" 文件的"),a("strong",[t._v("代码具体如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CopyrightWebpackPlugin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//编写一个构造器")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("compiler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//遇到同步时刻")]),t._v("\n    compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("compile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CopyrightWebpackPlugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'compiler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//遇到异步时刻")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//当要把代码放到dist目录之前，要走下面这个函数")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Compilation存放打包的所有内容，Compilation.assets放置生成的内容")]),t._v("\n    compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("emit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tapAsync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CopyrightWebpackPlugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("Compilation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("debugger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 往代码中增加一个文件，copyright.txt")]),t._v("\n        Compilation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("assets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'copyright.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("source")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'copyright by monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CopyrightWebpackPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("上面的这个插件中想要实现的功能就是，"),a("strong",[t._v("获取版权信息")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"_3-引用-plugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-引用-plugin"}},[t._v("#")]),t._v(" （3）引用 plugin")]),t._v(" "),a("p",[t._v("现在，我们在 "),a("code",[t._v("webpack.config.js")]),t._v(" 中，来引入我们上面的 "),a("code",[t._v("plugin")]),t._v(" 。"),a("strong",[t._v("具体配置如下：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" CopyrightWebpackPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./plugins/copyright-webpack-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'development'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/index.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CopyrightWebpackPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'monday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("output")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("filename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name].js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("通过上述代码，我们可以了解到，在（2）中，我们首先需要"),a("strong",[t._v("定义一个类")]),t._v("，之后呢，在类中写一个构造器和一个 "),a("code",[t._v("apply()")]),t._v(" 方法来调用。然后呢，大家看到（3），通过 "),a("code",[t._v("require")]),t._v(" 的方式，来进行 "),a("strong",[t._v("new 实例")]),t._v(" ，实例化一个插件，从而在项目中使用这个插件。")]),t._v(" "),a("p",[t._v("最终，我们项目进行打包时，就会生成一个 "),a("code",[t._v("dist")]),t._v(" 目录，并且在目录下增加一个 "),a("code",[t._v("copyright.txt")]),t._v(" 文件，并且文件中的内容就是 "),a("code",[t._v("copyright by monday")]),t._v(" 。")]),t._v(" "),a("h1",{attrs:{id:"💹-三、结束语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#💹-三、结束语"}},[t._v("#")]),t._v(" 💹 三、结束语")]),t._v(" "),a("p",[t._v("在上面的文章中，讲解了关于 loader 和 plugin 的基本编写思路，以及如何在项目中对他们进行运用，相信大家对这一块内容有了基础的认识。")]),t._v(" "),a("p",[t._v("到这里，loader 和 plugin 的编写讲解就结束啦！希望对大家有帮助~")]),t._v(" "),a("p",[t._v("如文章有误或有不理解的地方，欢迎小伙伴们评论区留言哦 💬")]),t._v(" "),a("p",[t._v("本文代码已上传至公众号，后台回复关键词 "),a("code",[t._v("webpack")]),t._v(" 即可获取~")]),t._v(" "),a("h1",{attrs:{id:"🐣-彩蛋-one-more-thing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🐣-彩蛋-one-more-thing"}},[t._v("#")]),t._v(" 🐣 彩蛋 One More Thing")]),t._v(" "),a("h2",{attrs:{id:"往期推荐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#往期推荐"}},[t._v("#")]),t._v(" （：往期推荐")]),t._v(" "),a("p",[t._v("webpack 入门核心知识 👉"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44803753/article/details/118728201",target:"_blank",rel:"noopener noreferrer"}},[t._v("不会 webpack 的前端可能是捡来的，万字总结 webpack 的超入门核心知识"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("webpack 入门进阶知识 👉"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44803753/article/details/118885391",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack 入门核心知识还看不过瘾？速来围观万字进阶知识"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("webpack 实战案例配置 👉"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44803753/article/details/118977647",target:"_blank",rel:"noopener noreferrer"}},[t._v("万字总结 webpack 实战案例配置"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"番外篇"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#番外篇"}},[t._v("#")]),t._v(" （：番外篇")]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("p",[t._v("关注公众号"),a("strong",[t._v("星期一研究室")]),t._v("，第一时间关注优质文章，"),a("strong",[t._v("更多精选专栏待你解锁")]),t._v("~")])]),t._v(" "),a("li",[a("p",[t._v("如果这篇文章对你有用，记得"),a("strong",[t._v("留个脚印 jio")]),t._v("再走哦~")])]),t._v(" "),a("li",[a("p",[t._v("以上就是本文的全部内容！我们下期见！👋👋👋")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);