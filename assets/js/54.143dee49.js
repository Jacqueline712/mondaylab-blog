(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{613:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("依稀记得我们在 vue 时，最上方总是有一个 "),a("code",[t._v("template")]),t._v(" 包围着。而很多时候，我们也没有很在意的去意识到 "),a("code",[t._v("<template></template>")]),t._v(" 究竟是什么。")]),t._v(" "),a("p",[t._v("在今天的这篇文章中，就带大家一起来了解，模板编译 "),a("code",[t._v("template")]),t._v(" 的背后，究竟发生了什么事情？")]),t._v(" "),a("p",[t._v("一起来了解模板编译的纸短情长 🚋🚋🚋")]),t._v(" "),a("h1",{attrs:{id:"一、📑-初识模板编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、📑-初识模板编译"}},[t._v("#")]),t._v(" 一、📑 初识模板编译")]),t._v(" "),a("h2",{attrs:{id:"_1、vue-组件中使用-render-代替-template"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、vue-组件中使用-render-代替-template"}},[t._v("#")]),t._v(" 1、vue 组件中使用 render 代替 template")]),t._v(" "),a("p",[a("code",[t._v("template")]),t._v(" ，即模板。模板是 "),a("code",[t._v("vue")]),t._v(" 开发中最常用的部分，即与 vue 的使用关联最紧密的原理。它不是 "),a("code",[t._v("html")]),t._v(" ，它有指令、有插值、也有 "),a("code",[t._v("JS")]),t._v(" 表达式，那它，到底是什么呢？我们来看个例子。")]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("vue")]),t._v(" 中定义一个组件，通常会使用 "),a("code",[t._v("template")]),t._v(" 模板字符串来定义一个组件。"),a("strong",[t._v("比如：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'heading'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("template")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("xxx")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("一般情况下，模板的定义是上面这种情况。同时，在程序编译期间，模板会将 "),a("code",[t._v("template")]),t._v(" 的这种"),a("strong",[t._v("字符串类型")]),t._v("，编译成 "),a("code",[t._v("render")]),t._v(" 函数。")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("但是呢，在有些复杂的情况下，可能就不能用 "),a("code",[t._v("template")]),t._v(" 函数了，这个时候会考虑直接用 "),a("code",[t._v("render")]),t._v(" 函数来定义一个组件。"),a("strong",[t._v("比如：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("component")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'heading'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("level"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//tag props")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//children")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("attrs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'headerId'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'headerId'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'this is a tag'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("就像上面这样子，我们也可以通过使用一个 "),a("code",[t._v("render")]),t._v(" 函数来定义一个组件。")]),t._v(" "),a("h2",{attrs:{id:"_2、模板编译总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、模板编译总结"}},[t._v("#")]),t._v(" 2、模板编译总结")]),t._v(" "),a("p",[t._v("看完上面的例子，我们来做个小结 ✨")]),t._v(" "),a("ul",[a("li",[t._v("template，即模板。这个模板会编译成 "),a("code",[t._v("render")]),t._v(" 函数，其中 "),a("code",[t._v("render")]),t._v(" 函数用的是 "),a("code",[t._v("with")]),t._v(" 语法。")]),t._v(" "),a("li",[t._v("过程：模板 → "),a("code",[t._v("render")]),t._v(" 函数 → "),a("code",[t._v("vnode")]),t._v(" → 组件渲染和更新过程。")]),t._v(" "),a("li",[a("code",[t._v("vue")]),t._v(" 组件可以用 "),a("code",[t._v("render")]),t._v(" 函数代替 "),a("code",[t._v("template")]),t._v(" 。")]),t._v(" "),a("li",[a("code",[t._v("React")]),t._v(" 一直都用 "),a("code",[t._v("render")]),t._v(" ，没有模板（这里仅作知识补充，不做讲解）。")])]),t._v(" "),a("h1",{attrs:{id:"二、✏️-感受模板编译的美"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、✏️-感受模板编译的美"}},[t._v("#")]),t._v(" 二、✏️ 感受模板编译的美")]),t._v(" "),a("h2",{attrs:{id:"_1、with-语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、with-语法"}},[t._v("#")]),t._v(" 1、with 语法")]),t._v(" "),a("h3",{attrs:{id:"_1-例子展示-🌰"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-例子展示-🌰"}},[t._v("#")]),t._v(" （1）例子展示 🌰")]),t._v(" "),a("p",[t._v("先来了解模板编译中一个很重要的知识点， "),a("code",[t._v("with")]),t._v(" 语法。下面先用一个例子来展示 with 语法与普通语法的不同。")]),t._v(" "),a("p",[a("strong",[t._v("不使用 with 语法执行程序时：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//undefined")]),t._v("\n")])])]),a("p",[a("strong",[t._v("使用 with 语法执行程序时：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用with，能改变 {} 内自由变量的查找方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将 {} 内自由变量，当作 obj 的属性来查找")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//会报错！！！")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-知识点归纳"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-知识点归纳"}},[t._v("#")]),t._v(" （2）知识点归纳")]),t._v(" "),a("p",[t._v("看完上面 with 语法的例子，我们来对 "),a("code",[t._v("with")]),t._v(" 语法做一个知识点归纳。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("with")]),t._v(" 语法会改变 "),a("code",[t._v("{}")]),t._v(" 内"),a("strong",[t._v("自由变量的查找规则")]),t._v("，当作 "),a("code",[t._v("obj")]),t._v(" 属性来查找；")]),t._v(" "),a("li",[t._v("如果在当前 "),a("code",[t._v("{}")]),t._v(" 内找不到匹配的 "),a("code",[t._v("obj")]),t._v(" 属性，就会报错；")]),t._v(" "),a("li",[a("code",[t._v("with")]),t._v(" 要谨慎使用，它打破了"),a("strong",[t._v("作用域规则")]),t._v("，会让其"),a("strong",[t._v("易读性变差")]),t._v("。")])]),t._v(" "),a("h1",{attrs:{id:"三、📈-编译模板"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、📈-编译模板"}},[t._v("#")]),t._v(" 三、📈 编译模板")]),t._v(" "),a("h2",{attrs:{id:"_1、编译模板碎碎念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、编译模板碎碎念"}},[t._v("#")]),t._v(" 1、编译模板碎碎念")]),t._v(" "),a("p",[t._v("在前面中我们讲过，模板它不是 "),a("code",[t._v("html")]),t._v(" ，它有"),a("strong",[t._v("指令")]),t._v("、有"),a("strong",[t._v("插值")]),t._v("、也有"),a("strong",[t._v("JS 表达式")]),t._v("，它能实现判断、也能实现循环。")]),t._v(" "),a("p",[t._v("试想一下模板为什么不是 "),a("code",[t._v("html")]),t._v(" ？")]),t._v(" "),a("p",[t._v("思考一下，假如你在写程序时，能用 "),a("code",[t._v("html")]),t._v(" 写出一个判断或者循环出来吗？答案自然时不行的。")]),t._v(" "),a("p",[t._v("所以说， "),a("code",[t._v("html")]),t._v(" 只是一个"),a("strong",[t._v("静态的标签语言")]),t._v("，你写什么它就显示什么，它没有办法实现一个逻辑，或者做循环和判断。")]),t._v(" "),a("p",[t._v("因此，对于前端浏览器而言，只有 "),a("code",[t._v("JS")]),t._v(" 才能实现判断和循环等各种逻辑功能。")]),t._v(" "),a("p",[t._v("所以，"),a("strong",[t._v("模板")]),t._v("一定是"),a("strong",[t._v("转换为某种 "),a("code",[t._v("JS")]),t._v(" 代码")]),t._v("之后才进行运行的。而这个模板怎么转换成 "),a("code",[t._v("js")]),t._v(" 代码的这个过程，就称为"),a("strong",[t._v("编译模板")]),t._v("。")]),t._v(" "),a("p",[t._v("那这个模板是怎么转的呢？接下来我们来看下编译模板的过程。")]),t._v(" "),a("h2",{attrs:{id:"_2、编译模板过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、编译模板过程"}},[t._v("#")]),t._v(" 2、编译模板过程")]),t._v(" "),a("h3",{attrs:{id:"_1-初始化一个-npm-环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-初始化一个-npm-环境"}},[t._v("#")]),t._v(" （1）初始化一个 npm 环境")]),t._v(" "),a("p",[t._v("首先先建立一个新文件，可以命名为 "),a("code",[t._v("vue-template-complier-demo")]),t._v(" 。之后用以下命令行初始化一个 npm 的环境：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" init -y\n")])])]),a("h3",{attrs:{id:"_2-安装编译器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装编译器"}},[t._v("#")]),t._v(" （2）安装编译器")]),t._v(" "),a("p",[a("code",[t._v("npm")]),t._v(" 安装模板编译器。"),a("strong",[t._v("命令行如下：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" vue-template-compiler --save\n")])])]),a("h3",{attrs:{id:"_3-新建新文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-新建新文件"}},[t._v("#")]),t._v(" （3）新建新文件")]),t._v(" "),a("p",[t._v("在根目录下初始化新建一个 "),a("code",[t._v("index.js")]),t._v(" 文件，并引入 "),a("code",[t._v("vue-template-compiler")]),t._v(" 。代码如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入vue-template-compiler")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" compiler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-template-compiler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编译")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("接下来我们就来看下，模板中的插值、表达式、属性和动态属性等等类型的编译，到底是怎么样的？")]),t._v(" "),a("h3",{attrs:{id:"_4-了解缩写函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-了解缩写函数"}},[t._v("#")]),t._v(" （4）了解缩写函数")]),t._v(" "),a("p",[t._v("以下 vue 源码中的缩写函数先了解，将在下面的讲解中用到。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 vue 源码中找到缩写函数的含义")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("installRenderHelpers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" createElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_o "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" markOnce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" toNumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" toString"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_l "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderSlot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_q "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" looseEqual"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" looseIndexOf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_m "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderStatic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resolveFilter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_k "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" checkKeyCodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bindObjectProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" createTextVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_e "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" createEmptyVNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_u "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" resolveScopedSlots"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_g "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bindObjectListeners"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bindDynamicKeys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" prependModifier"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_5-编译插值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-编译插值"}},[t._v("#")]),t._v(" （5）编译插值")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入vue-template-compiler")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" compiler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-template-compiler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<p>{{message}}</p>")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// with(this){return createElement('p',[createTextVNode(toString(message))])}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// h -> vnode")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// createElement -> vnode")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编译")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111638271.png#pic_",alt:"编译插值"}})]),t._v(" "),a("p",[t._v("从上图中可以看到，"),a("strong",[t._v("插值")]),t._v("类型的模板最终被编译成一个 "),a("code",[t._v("with")]),t._v(" 语句，并且这个 "),a("code",[t._v("with")]),t._v(" 语句的参数都指向了 "),a("code",[t._v("this")]),t._v(" 。")]),t._v(" "),a("p",[t._v("同时，大家可以看到，里面有一个 "),a("code",[t._v("_c")]),t._v(" ， "),a("code",[t._v("_v")]),t._v(" ， "),a("code",[t._v("_s")]),t._v("。那这几个元素是什么呢？")]),t._v(" "),a("p",[t._v("这个就是上面第四点中提到的 "),a("code",[t._v("vue")]),t._v(" 源码中的缩写函数。 "),a("code",[t._v("_c")]),t._v(" 对应的就是源码中的 "),a("code",[t._v("createElement")]),t._v("， "),a("code",[t._v("_v")]),t._v(" 对应的就是源码中的 "),a("code",[t._v("createTextVNode")]),t._v(" ，"),a("code",[t._v("_s")]),t._v(" 对应的就是源码中的 "),a("code",[t._v("toString")]),t._v(" 。")]),t._v(" "),a("p",[t._v("所以，以上编译后的 "),a("code",[t._v("with")]),t._v(" 语句 "),a("code",[t._v("with(this){return _c('p',[_v(_s(message))])}")]),t._v(" ，事实上就是 "),a("code",[t._v("with(this){return createElement('p',[createTextVNode(toString(message))])}")]),t._v(" 。")]),t._v(" "),a("p",[t._v("以上这个语句的意思为，编译创建一个 "),a("code",[t._v("p")]),t._v(" 元素，之后呢， "),a("code",[t._v("p")]),t._v(" 元素就没有子元素了，于是就创建它的文本节点 "),a("code",[t._v("message")]),t._v(" ，同时 "),a("code",[t._v("message")]),t._v(" 是字符串的形式存在，因此要进行 "),a("code",[t._v("toString")]),t._v(" 。")]),t._v(" "),a("p",[t._v("额外再补充一个知识点， "),a("code",[t._v("createElement")]),t._v(" 其实就等于我们平常所说的 "),a("code",[t._v("h")]),t._v(" 函数，返回的是一个 "),a("code",[t._v("虚拟DOM")]),t._v(" 节点。")]),t._v(" "),a("p",[t._v("以上就是一个"),a("strong",[t._v("插值模板")]),t._v("编译的过程，下面再用几个例子让大家熟悉。")]),t._v(" "),a("h3",{attrs:{id:"_6-编译表达式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-编译表达式"}},[t._v("#")]),t._v(" （6）编译表达式")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入vue-template-compiler")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" compiler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-template-compiler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 表达式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("<p>{{flag ? message : 'no message found'}}</p>")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// with(this){return _c('p',[_v(_s(flag ? message : 'no message found'))])}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编译")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111652962.png#",alt:"表达式"}})]),t._v(" "),a("p",[t._v("依据上面插值的分析方法，我们来分析"),a("strong",[t._v("表达式")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[a("strong",[t._v("表达式")]),t._v("编译后的结果返回了一个虚拟 "),a("code",[t._v("DOM")]),t._v(" 节点，同样地，查询 "),a("code",[t._v("vue")]),t._v(" 源码中的缩写函数我们可以发现， "),a("code",[t._v("with(this){return _c('p',[_v(_s(flag ? message : 'no message found'))])}")]),t._v(" 最终的结果等于 "),a("code",[t._v("with(this){return createElement('p',[createTextVnode(toString(flag ? message : 'no message found'))])}")]),t._v(" 。")]),t._v(" "),a("p",[t._v("先创建了一个 "),a("code",[t._v("p")]),t._v(" 元素，之后 "),a("code",[t._v("p")]),t._v(" 元素"),a("strong",[t._v("没有子元素")]),t._v("了，于是"),a("strong",[t._v("创建文本节点")]),t._v("，最终 "),a("code",[t._v("toString")]),t._v(" 三目表达式里面的内容。")]),t._v(" "),a("h3",{attrs:{id:"_7-编译属性和动态属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-编译属性和动态属性"}},[t._v("#")]),t._v(" （7）编译属性和动态属性")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入vue-template-compiler")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" compiler "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-template-compiler'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属性和动态属性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n    <div id="div1" class="container">\n        <img :src="imgUrl"/>\n    </div>\n')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// with(this){return _c('div',")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//      {staticClass:"container",attrs:{"id":"div1"}},')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      [")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//          _c('img',{attrs:{\"src\":imgUrl}})])}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编译")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" compiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111716251.png#",alt:"属性和动态属性"}})]),t._v(" "),a("p",[t._v("依据上面的分析方法，我们来分析"),a("strong",[t._v("属性和动态属性")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[a("strong",[t._v("属性和动态属性")]),t._v("编译后的结果返回了一个虚拟 "),a("code",[t._v("DOM")]),t._v(" 节点，同样地，查询 "),a("code",[t._v("vue")]),t._v(" 源码中的"),a("strong",[t._v("缩写函数")]),t._v("我们可以发现， "),a("code",[t._v('with(this){return _c(\'div\',{staticClass:"container",attrs:{"id":"div1"}},[_c(\'img\',{attrs:{"src":imgUrl}})])}')]),t._v(" 最终的结果等于 "),a("code",[t._v('with(this){return createElement(\'div\',{staticClass:"container",attrs:{"id":"div1"}},[createElement(\'img\',{attrs:{"src":imgUrl}})])}')]),t._v(" 。")]),t._v(" "),a("p",[t._v("此时我们可以看到，返回的 "),a("code",[t._v("vnode")]),t._v(" 节点中，包含 "),a("code",[t._v("class")]),t._v(" 名字， "),a("code",[t._v("container")]),t._v(" 。此时 "),a("code",[t._v("div")]),t._v(" 有一个 "),a("code",[t._v("id")]),t._v(" 选择器，这个 "),a("code",[t._v("id")]),t._v(" 选择器是该 "),a("code",[t._v("div")]),t._v(" 的一个属性，于是就通过 attrs 来表示。")]),t._v(" "),a("p",[t._v("最外层结束后，里面还有一层， "),a("code",[t._v("img")]),t._v(" 。 "),a("code",[t._v("img")]),t._v(" 可以视其为跟 "),a("code",[t._v("div")]),t._v(" 一样的标签，于是先创建 "),a("code",[t._v("img")]),t._v(" 元素，又因为 "),a("code",[t._v("img")]),t._v(" 绑定了一个具体的值，就像是 "),a("code",[t._v("div")]),t._v(" 里面绑定了 "),a("code",[t._v("id")]),t._v(" 选择器。所以在创建完 "),a("code",[t._v("img")]),t._v(" 的值之后，继续用 "),a("code",[t._v("attrs")]),t._v(" 来传递 "),a("code",[t._v("img")]),t._v(" 所绑定的值。")]),t._v(" "),a("h3",{attrs:{id:"_8-编译条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-编译条件"}},[t._v("#")]),t._v(" （8）编译条件")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 条件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n    <div>\n        <p v-if=\"flag === 'a'\">A</p>\n        <p v-else>B</p>\n    </div>\n")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// with(this){return _c('div',[(flag === 'a')?_c('p',[_v(\"A\")]):_c('p',[_v(\"B\")])])}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111730979.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#",alt:"条件"}})]),t._v(" "),a("p",[t._v("依据上面的分析方法，我们来分析"),a("strong",[t._v("条件")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[t._v("对于"),a("strong",[t._v("条件")]),t._v("来说，首先是先创建一个 "),a("code",[t._v("div")]),t._v(" 元素，之后呢，模板编译把 "),a("code",[t._v("v-if")]),t._v(" 和 "),a("code",[t._v("v-else")]),t._v(" 分割成一个三目表达式的方式来进行编译。")]),t._v(" "),a("h3",{attrs:{id:"_9-编译循环"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-编译循环"}},[t._v("#")]),t._v(" （9）编译循环")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 循环")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n    <ul>\n        <li v-for="item in list" :key="item.id">{{item.title}}</li>\n    </ul>\n')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// with(this){return _c('ul',_l((list),function(item){return _c('li',{key:item.id},[_v(_s(item.title))])}),0)}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111742344.png#",alt:"循环"}})]),t._v(" "),a("p",[t._v("依据上面的分析方法，我们来分析"),a("strong",[t._v("循环")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[t._v("对于以上"),a("strong",[t._v("循环")]),t._v("来说，首先会创建一个 "),a("code",[t._v("ul")]),t._v(" 元素，之后查询 "),a("code",[t._v("_l")]),t._v(" 的缩写函数我们知道它是 "),a("code",[t._v("renderlist")]),t._v(" ， 所以 "),a("code",[t._v("list")]),t._v(" 列表会被 "),a("code",[t._v("renderList")]),t._v(" 函数进行编译。")]),t._v(" "),a("p",[t._v("最后渲染后的 "),a("code",[t._v("item")]),t._v(" 被当作"),a("strong",[t._v("函数的参数")]),t._v("进行传递，并列返回对应 "),a("code",[t._v("item")]),t._v(" 的 "),a("code",[t._v("li")]),t._v(" 列表元素。")]),t._v(" "),a("h3",{attrs:{id:"_10-编译事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-编译事件"}},[t._v("#")]),t._v(" （10）编译事件")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 事件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n    <button @click="clickHandler">submit</button>\n')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// with(this){return _c(\'button\',{on:{"click":clickHandler}},[_v("submit")])}')]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111754309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#",alt:"事件"}})]),t._v(" "),a("p",[t._v("依据上面的分析方法，我们来分析"),a("strong",[t._v("事件")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[t._v("对于"),a("strong",[t._v("事件")]),t._v("来说，首先会创建一个 "),a("code",[t._v("button")]),t._v(" 元素，之后 "),a("code",[t._v("@click")]),t._v(" 即 "),a("code",[t._v("v-on:click")]),t._v(" 会被编译成 "),a("code",[t._v('on:{"click":clickHandler}')]),t._v(" 。最后是 "),a("code",[t._v("_v")]),t._v(" ，即 "),a("code",[t._v("createTextVNode")]),t._v(" 。创建一个 "),a("code",[t._v("submit")]),t._v(" 的文本节点，将 "),a("code",[t._v("click")]),t._v(" 的内容提交上去。")]),t._v(" "),a("h3",{attrs:{id:"_11-编译-v-model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-编译-v-model"}},[t._v("#")]),t._v(" （11）编译 v-model")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// v-model")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('<input type="text" v-model="name">')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 主要看 input 事件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// with(this){return _c(\'input\',{directives:[{name:"model",rawName:"v-model",value:(name),expression:"name"}],attrs:{"type":"text"},domProps:{"value":(name)},on:{"input":function($event){if($event.target.composing)return;name=$event.target.value}}})}')]),t._v("\n")])])]),a("p",[a("strong",[t._v("编译以上内容，打印结果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111805662.png#",alt:"v-model"}})]),t._v(" "),a("p",[t._v("依据上面的分析方法，我们来分析"),a("strong",[t._v("双向绑定 v-model")]),t._v("的模板编译过程。")]),t._v(" "),a("p",[t._v("对于 "),a("code",[t._v("v-model")]),t._v(" 来说，主要看的是 "),a("code",[t._v("input")]),t._v(" 事件。 "),a("code",[t._v("v-model")]),t._v(" 的背后，绑定的是 "),a("code",[t._v("name")]),t._v(" 和 "),a("code",[t._v("value")]),t._v(" 这两个语法糖。之后通过 "),a("code",[t._v("attrs")]),t._v(" 去创建 "),a("code",[t._v("类型type")]),t._v(" 为 "),a("code",[t._v("text")]),t._v(" 的属性。")]),t._v(" "),a("p",[t._v("最终是 "),a("code",[t._v("input")]),t._v(" 事件， "),a("code",[t._v("input")]),t._v(" 事件绑定 "),a("code",[t._v("$event")]),t._v(" ，最后， "),a("code",[t._v("name")]),t._v(" 的值就等同于 "),a("code",[t._v("$event.target.value")]),t._v(" ，这样，"),a("strong",[t._v("数据就实现了双向绑定")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"_3、模板编译总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、模板编译总结"}},[t._v("#")]),t._v(" 3、模板编译总结")]),t._v(" "),a("p",[t._v("看完上述的内容，我们来对"),a("strong",[t._v("模板编译做个小结：")])]),t._v(" "),a("p",[a("strong",[t._v("（1）从 render 函数到 vnode")])]),t._v(" "),a("p",[t._v("模板编译后是一个 "),a("code",[t._v("render")]),t._v(" 函数，执行 "),a("code",[t._v("render")]),t._v(" 函数后返回一个 "),a("code",[t._v("vnode")]),t._v(" ；")]),t._v(" "),a("p",[a("strong",[t._v("（2）vnode 到 patch 和 diff")])]),t._v(" "),a("p",[t._v("基于 "),a("code",[t._v("vnode")]),t._v(" 的基础上，再执行 "),a("code",[t._v("patch")]),t._v(" 和 "),a("code",[t._v("diff")]),t._v(" ；")]),t._v(" "),a("p",[a("strong",[t._v("（3）模板编译工具")])]),t._v(" "),a("p",[t._v("在平常的开发中，我们可以使用 "),a("code",[t._v("webpack")]),t._v(" 、 "),a("code",[t._v("vue-loader")]),t._v(" 等构建工具，在开发环境下"),a("strong",[t._v("编译模板")]),t._v("。")]),t._v(" "),a("h1",{attrs:{id:"四、🔑-组件渲染-更新过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、🔑-组件渲染-更新过程"}},[t._v("#")]),t._v(" 四、🔑 组件渲染/更新过程")]),t._v(" "),a("h2",{attrs:{id:"_1、初识组件渲染-更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、初识组件渲染-更新"}},[t._v("#")]),t._v(" 1、初识组件渲染/更新")]),t._v(" "),a("p",[t._v("讲完上完的内容，我们再来讲一个与编译模板关联性很强的知识点："),a("strong",[t._v("组件渲染/更新过程")]),t._v("。")]),t._v(" "),a("p",[t._v("一个组件，从"),a("strong",[t._v("渲染到页面上")]),t._v("开始，再到修改 "),a("code",[t._v("data")]),t._v(" 去触发更新（数据驱动视图），其背后的原理是什么，又需要掌握哪些要点呢？")]),t._v(" "),a("p",[t._v("事实上，组件在渲染之前，会先进行"),a("strong",[t._v("模板编译")]),t._v("，模板 "),a("code",[t._v("template")]),t._v(" 会编译成 "),a("code",[t._v("render")]),t._v(" 函数。")]),t._v(" "),a("p",[t._v("之后就是数据的监听了，这就要谈到"),a("strong",[t._v("响应式数据")]),t._v("。vue 的"),a("strong",[t._v("响应式")]),t._v("通过操作 "),a("code",[t._v("Object.defineProperty()")]),t._v(" ，去监听 "),a("code",[t._v("getter")]),t._v(" 和 "),a("code",[t._v("setter")]),t._v(" 方法，来使得数据实时更新。")]),t._v(" "),a("p",[t._v("监听完数据之后，就是执行 "),a("code",[t._v("render")]),t._v(" 函数，生成 "),a("code",[t._v("vnode")]),t._v(" 。")]),t._v(" "),a("p",[t._v("到了 "),a("code",[t._v("vnode")]),t._v(" （即 "),a("code",[t._v("vdom")]),t._v(" ）这一步之后，会进行 "),a("code",[t._v("patch(elem,vnode)")]),t._v(" 和 "),a("code",[t._v("patch(vnode,newVnode)")]),t._v(" 的比较。")]),t._v(" "),a("p",[t._v("关于"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44803753/article/details/117535265",target:"_blank",rel:"noopener noreferrer"}},[t._v("响应式原理"),a("OutboundLink")],1),t._v("和"),a("a",{attrs:{href:"https://blog.csdn.net/weixin_44803753/article/details/117594534",target:"_blank",rel:"noopener noreferrer"}},[t._v("vdom 的解读"),a("OutboundLink")],1),t._v("，如有需要可以查看我的前两篇文章进行学习，这里不再展开细述~")]),t._v(" "),a("h2",{attrs:{id:"_2、组件渲染-更新过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、组件渲染-更新过程"}},[t._v("#")]),t._v(" 2、组件渲染/更新过程")]),t._v(" "),a("p",[t._v("组件渲染和更新过程主要经过以下三个步骤："),a("strong",[t._v("初次渲染过程 → 更新过程 → 异步渲染")]),t._v("。")]),t._v(" "),a("p",[t._v("接下来就这三个步骤进行一一讲解。")]),t._v(" "),a("h3",{attrs:{id:"_1-初次渲染过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-初次渲染过程"}},[t._v("#")]),t._v(" （1）初次渲染过程")]),t._v(" "),a("p",[t._v("初次渲染过程，即组件第一次渲染是怎么样的，怎么把模板渲染到页面上。"),a("strong",[t._v("具体有以下三个步骤：")])]),t._v(" "),a("ul",[a("li",[t._v("解析模板为 "),a("code",[t._v("render")]),t._v(" 函数；")]),t._v(" "),a("li",[t._v("触发响应式，监听 "),a("code",[t._v("data")]),t._v(" 属性 "),a("code",[t._v("getter")]),t._v(" 和 "),a("code",[t._v("setter")]),t._v(" ；")]),t._v(" "),a("li",[t._v("执行 "),a("code",[t._v("render")]),t._v(" 函数，生成 "),a("code",[t._v("vnode")]),t._v(" ，进行 "),a("code",[t._v("patch(elem,vnode)")]),t._v(" 。")])]),t._v(" "),a("p",[t._v("下面就这三个步骤来进行一一讲解。")]),t._v(" "),a("h4",{attrs:{id:"_1-解析模板为-render-函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-解析模板为-render-函数"}},[t._v("#")]),t._v(" 1）解析模板为 render 函数")]),t._v(" "),a("p",[t._v("在"),a("strong",[t._v("开发环境")]),t._v("下，解析模板为 "),a("code",[t._v("render")]),t._v(" 函数一般是由 "),a("code",[t._v("vue-loader")]),t._v(" 这个插件来处理的。还有一种情况就是，用户直接用 "),a("code",[t._v("cdn")]),t._v(" 的方式引入 "),a("code",[t._v("vuejs")]),t._v(" 的文件进行本地代码练习，这种情况下，解析模板为 "),a("code",[t._v("render")]),t._v(" 函数就是在"),a("strong",[t._v("浏览器环境")]),t._v("运行的。")]),t._v(" "),a("p",[t._v("小知识了解完，我们来看下这个步骤。")]),t._v(" "),a("p",[t._v("解析模板为 "),a("code",[t._v("render")]),t._v(" 函数，即解析 "),a("code",[t._v("template")]),t._v(" 为 "),a("code",[t._v("render")]),t._v(" 函数，这个就是上述文章中说的"),a("strong",[t._v("编译模板")]),t._v("。")]),t._v(" "),a("h4",{attrs:{id:"_2-触发响应式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-触发响应式"}},[t._v("#")]),t._v(" 2）触发响应式")]),t._v(" "),a("p",[t._v("在编译完模板之后， "),a("code",[t._v("render")]),t._v(" 函数有了，我们来开始监听 "),a("code",[t._v("data")]),t._v(" 属性。")]),t._v(" "),a("p",[t._v("监听 "),a("code",[t._v("data")]),t._v(" 属性，这个时候我们就需要触发响应式，也就是渲染数据。")]),t._v(" "),a("p",[t._v("那在这个阶段怎么渲染数据呢？")]),t._v(" "),a("p",[t._v("这个阶段我们需要执行 "),a("code",[t._v("render")]),t._v(" 函数， "),a("code",[t._v("render")]),t._v(" 函数会触发 "),a("code",[t._v("getter")]),t._v(" 方法，因为数据没有进行更新，只是进行渲染。只有在进行渲染的时候才会操作 "),a("code",[t._v("setter")]),t._v(" 方法。")]),t._v(" "),a("h4",{attrs:{id:"_3-执行-render-函数-生成-vnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-执行-render-函数-生成-vnode"}},[t._v("#")]),t._v(" 3）执行 render 函数，生成 vnode")]),t._v(" "),a("p",[t._v("最后，当数据渲染完毕后，就会执行第一步生成的 "),a("code",[t._v("render")]),t._v(" 函数，然后生成虚拟 "),a("code",[t._v("DOM")]),t._v(" 节点 "),a("code",[t._v("vnode")]),t._v(" ，之后进行 "),a("code",[t._v("patch(elem,vnode)")]),t._v(" 。")]),t._v(" "),a("h3",{attrs:{id:"_2-更新过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-更新过程"}},[t._v("#")]),t._v(" （2）更新过程")]),t._v(" "),a("h4",{attrs:{id:"_1-更新过程细述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新过程细述"}},[t._v("#")]),t._v(" 1）更新过程细述")]),t._v(" "),a("p",[t._v("更新过程，即 "),a("code",[t._v("data")]),t._v(" 修改之后，组件是怎么更新的。")]),t._v(" "),a("p",[t._v("在这个阶段呢，将会修改 "),a("code",[t._v("data")]),t._v(" ，并且触发 "),a("code",[t._v("setter")]),t._v(" （注意：在此之前 "),a("code",[t._v("data")]),t._v(" 在 "),a("code",[t._v("getter")]),t._v(" 中已经被监听）。")]),t._v(" "),a("p",[t._v("触发完 "),a("code",[t._v("setter")]),t._v(" 之后，重新执行 "),a("code",[t._v("render")]),t._v(" 函数，并生成 "),a("code",[t._v("newVnode")]),t._v(" ，最后进行 "),a("code",[t._v("patch(vnode, newVnode)")]),t._v(" 的 diff 比较。")]),t._v(" "),a("h4",{attrs:{id:"_2-完成流程图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-完成流程图"}},[t._v("#")]),t._v(" 2）完成流程图")]),t._v(" "),a("p",[t._v("接下来我们用一张流程图来完整的回顾渲染和更新的过程。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210609111845989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#",alt:"模板编译流程图"}})]),t._v(" "),a("h3",{attrs:{id:"_3-异步渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-异步渲染"}},[t._v("#")]),t._v(" （3）异步渲染")]),t._v(" "),a("p",[t._v("在渲染和更新结束之后，我们的程序可能还有可能会发生多个程序同时加载，这就涉及到一个"),a("strong",[t._v("异步渲染")]),t._v("问题。")]),t._v(" "),a("p",[t._v("异步渲染问题，我们用 "),a("code",[t._v("$nextTick")]),t._v(" 来作为例子讲解。")]),t._v(" "),a("p",[t._v("假设我们现在要实现一个功能，当我们点击按钮时，打印出列表的项数。这个时候我们大多人可能会这么操作。")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- ref的设置时为了方便后续可以用来：取节点的DOM元素 --\x3e")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ul1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("(item, index) in list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{item}}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("addItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("添加一项"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("methods")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取 DOM 元素")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ulElem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ul1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ulElem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[a("strong",[t._v("此时浏览器的显示效果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210602081408685.gif#pic_center",alt:"nextTick"}})]),t._v(" "),a("p",[t._v("细心的小伙伴已经发现，浏览器并没有按照我们所想的打印。当页面上的列表显示 "),a("code",[t._v("6项")]),t._v(" 内容时，此时控制台只打印 "),a("code",[t._v("3项")]),t._v(" ；当显示 "),a("code",[t._v("9项")]),t._v(" 时，此时控制台直接只打印 "),a("code",[t._v("6项")]),t._v(" 。")]),t._v(" "),a("p",[a("strong",[t._v("那这究竟时为什么呢？")])]),t._v(" "),a("p",[t._v("其实，当我们点击的那一刻， "),a("code",[t._v("data")]),t._v(" 发生变化，但是 "),a("code",[t._v("DOM")]),t._v(" 并不会立刻进行渲染。所以等到我们点击完成的时候，获取的元素还是原来触发的内容，而不会增添上新的内容。")]),t._v(" "),a("p",[t._v("那我们所期望的是，当点击之后立刻触发 "),a("code",[t._v("DOM")]),t._v(" 渲染并拿到最新的值。这个时候就需要用到 "),a("code",[t._v("nextTick")]),t._v(" 。"),a("strong",[t._v("具体代码如下：")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'c'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("methods")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 异步渲染，$nextTick 待 DOM 渲染完再回调，")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    即NextTick函数会在多次data修改完并且全部DOM渲染完再触发，仅在最后触发一次")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 页面渲染时会将 data 的修改做整合")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$nextTick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取 DOM 元素")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ulElem "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ul1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ulElem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("我们通过给获取 "),a("code",[t._v("DOM")]),t._v(" 元素的代码外面再嵌套一层 "),a("code",[t._v("$nextTick")]),t._v(" 函数，来达到我们想要的效果。在此过程中，当我们点击结束后， "),a("code",[t._v("data")]),t._v(" 的值发生变化，此时 "),a("code",[t._v("$nextTick")]),t._v(" 会等待"),a("strong",[t._v("DOM 全部渲染完成之后")]),t._v("再进行回调。")]),t._v(" "),a("p",[a("strong",[t._v("最终浏览器的打印效果如下：")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210602081420169.gif#pic_center",alt:"nextTick2"}})]),t._v(" "),a("p",[t._v("所以，也就是说， "),a("code",[t._v("$nextTick")]),t._v(" 通过汇总 "),a("code",[t._v("data")]),t._v(" 的修改，最后再"),a("strong",[t._v("一次性更新视图")]),t._v("。")]),t._v(" "),a("p",[t._v("这样可以减少 "),a("code",[t._v("DOM")]),t._v(" 的操作次数，大大的提高了性能。")]),t._v(" "),a("h2",{attrs:{id:"_3、小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、小结"}},[t._v("#")]),t._v(" 3、小结")]),t._v(" "),a("p",[t._v("经过上述一系列的讲解，我们可以把内容分割成以下"),a("strong",[t._v("两个要点：")])]),t._v(" "),a("ul",[a("li",[t._v("要理解清楚"),a("strong",[t._v("渲染和响应式")]),t._v("、"),a("strong",[t._v("渲染和模板编译")]),t._v("、"),a("strong",[t._v("渲染和 vdom")]),t._v("的关系。")]),t._v(" "),a("li",[t._v("要理解组件渲染/更新的过程："),a("strong",[t._v("初次渲染过程 → 更新过程 → 异步渲染")]),t._v("。")])]),t._v(" "),a("h1",{attrs:{id:"五、✔️-结束语"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、✔️-结束语"}},[t._v("#")]),t._v(" 五、✔️ 结束语")]),t._v(" "),a("p",[t._v("从模板编译，到组件渲染更新过程，我们了解了整个 "),a("code",[t._v("template")]),t._v(" 背后的全过程。相信通过本文的学习，大家对模板编译有了一个更深的认识。")]),t._v(" "),a("p",[t._v("关于模板编译的内容就讲到这里啦！如有不理解或文章有误，欢迎评论区留言或私信我交流~")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("关注公众号 "),a("strong",[t._v("星期一研究室")]),t._v(" ，不定期分享学习干货，"),a("strong",[t._v("更多有趣的专栏待你解锁")]),t._v("~")]),t._v(" "),a("li",[t._v("如果这篇文章对你有帮助，记得 "),a("strong",[t._v("点个赞加个关注")]),t._v(" 再走哦~")]),t._v(" "),a("li",[t._v("我们下期见！🥂🥂🥂")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);